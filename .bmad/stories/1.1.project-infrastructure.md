# Story 1.1: Project Infrastructure & Web Control Panel Foundation

## Status: Draft
**Priority:** 1 (Critical - Foundation)
**Depends On:** None (First story)

## Story Statement
**As a** development team and creator,
**I want** comprehensive project setup with immediate creator interface,
**So that** creators can access the system while we maintain development efficiency.

## Acceptance Criteria
1. ✅ pnpm workspace monorepo configured with mobile architecture planning documentation
2. ✅ Next.js 15 control panel with basic creator signup, authentication, and microphone permissions
3. ✅ Shared packages with mobile compatibility: effects-engine, protocol, brand-kit, config
4. ✅ CI/CD pipeline with performance profiling infrastructure and mobile testing preparation
5. ✅ Security framework (Doppler, CSP, SRI) with mobile app security requirements documented
6. ✅ Basic creator dashboard with system status and connection indicators

## Dev Notes

### Epic Context
This story establishes the foundation for the entire VibeLayerAI platform. It creates the monorepo structure, sets up the control panel web application, and initializes shared packages that will be used throughout Epic 1 and beyond.

### Story Dependencies
- **Blocks:** All other stories depend on this infrastructure
- **Enables:** Stories 1.2-1.8 can begin after this is complete
- **Parallel Potential:** None - must complete first

### Technical Architecture

#### Technology Stack (from docs/architecture/3-tech-stack.md)
- **Frontend:** TypeScript 5.6.3, Next.js 15.x, shadcn/ui, Zustand 5.x
- **Backend:** Node.js 20.x LTS, Fastify 5.x
- **Build:** Turbo 2.x, pnpm workspace
- **Testing:** Vitest 2.x, Playwright 1.x
- **Auth:** BetterAuth with JWT + EdDSA
- **Database:** Convex (real-time with live queries)
- **Styling:** Tailwind CSS 4.x

#### Project Structure (from docs/architecture/12-unified-project-structure.md)
```
vibelayer-ai/
├── apps/
│   ├── control-panel/        # Next.js 15 web app
│   ├── api-services/         # Backend services
│   └── mobile-*/             # Future mobile apps
├── packages/
│   ├── shared-types/         # TypeScript interfaces
│   ├── effects-engine/       # Cross-platform rendering
│   ├── protocol/             # WebSocket definitions
│   ├── brand-kit/            # Brand consistency
│   ├── ui-components/        # Shared React components
│   └── config/               # Shared configurations
├── infrastructure/           # Pulumi IaC
└── scripts/                  # Build and deploy scripts
```

### Implementation Tasks

#### Task 1: Initialize Monorepo Structure
- [ ] Create root package.json with pnpm workspace configuration
- [ ] Set up pnpm-workspace.yaml with proper app/package paths
- [ ] Configure Turbo 2.x with turbo.json for build orchestration
- [ ] Create root TypeScript configuration with path mappings
- [ ] Set up ESLint and Prettier configurations

#### Task 2: Create Control Panel Application
- [ ] Initialize Next.js 15 app in apps/control-panel/
- [ ] Configure Next.js with App Router structure
- [ ] Set up Tailwind CSS 4.x with custom design tokens
- [ ] Install and configure shadcn/ui components
- [ ] Create basic layout with navigation structure

#### Task 3: Implement Authentication System
- [ ] Install and configure BetterAuth with JWT + EdDSA
- [ ] Create signup flow with email verification
- [ ] Implement signin with session management
- [ ] Add microphone permission request flow
- [ ] Create protected route middleware

#### Task 4: Set Up Shared Packages
- [ ] Create packages/shared-types with base TypeScript interfaces
- [ ] Initialize packages/effects-engine with core structure
- [ ] Set up packages/protocol with WebSocket message types
- [ ] Create packages/brand-kit with initial scoring logic
- [ ] Configure packages/config with shared settings

#### Task 5: Implement Basic Dashboard
- [ ] Create dashboard layout with system status indicators
- [ ] Add connection status component (WebSocket readiness)
- [ ] Implement creator profile section
- [ ] Add placeholder for effect controls
- [ ] Create responsive mobile-first design

#### Task 6: Configure CI/CD Pipeline
- [ ] Set up GitHub Actions workflow for testing
- [ ] Configure build validation with Turbo
- [ ] Add Playwright E2E test infrastructure
- [ ] Set up deployment pipeline for Vercel
- [ ] Configure performance monitoring with Sentry

#### Task 7: Implement Security Framework
- [ ] Set up Doppler for secrets management
- [ ] Configure Content Security Policy (CSP)
- [ ] Implement Subresource Integrity (SRI)
- [ ] Add rate limiting middleware
- [ ] Document mobile security requirements

### File Locations
- Root configuration: `/package.json`, `/pnpm-workspace.yaml`, `/turbo.json`
- Control panel app: `/apps/control-panel/`
- Shared packages: `/packages/*/`
- CI/CD: `/.github/workflows/`
- Infrastructure: `/infrastructure/`

### Testing Requirements
- Unit tests for auth flows using Vitest
- Component tests for dashboard UI
- E2E tests for signup/signin flow with Playwright
- Performance benchmarks for initial load time
- Security audit for authentication system

### Technical Constraints
- Must use exact versions specified in tech stack
- Monorepo must support future iOS/Android apps
- Authentication must support WebSocket connections
- Dashboard must be mobile-responsive
- Build time must be under 5 minutes

## Definition of Done
- [ ] Monorepo structure created and configured
- [ ] Control panel accessible at localhost:3000
- [ ] Authentication flow working end-to-end
- [ ] Dashboard shows connection status
- [ ] All shared packages initialized
- [ ] CI/CD pipeline passing all checks
- [ ] Security framework documented
- [ ] Unit tests passing (>80% coverage)
- [ ] E2E tests for critical paths passing
- [ ] Documentation updated in /docs