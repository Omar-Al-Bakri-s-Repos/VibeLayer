# Story 1.7: Control Panel Core Interface

## Status: Draft
**Priority:** 2 (Core UI)
**Depends On:** Stories 1.1, 1.2, 1.5 (needs infrastructure, WebSocket, and effects to display)

## Story Statement
**As a** creator,
**I want** an intuitive web interface to monitor suggestions, manage effects, and control settings,
**So that** I can operate the system efficiently while streaming.

## Acceptance Criteria
1. ✅ Live suggestion queue displays AI recommendations with confidence indicators
2. ✅ Manual effect library with instant search and category filtering
3. ✅ Basic settings panel for audio thresholds and auto-trigger controls
4. ✅ Effect activation history with timestamps and source tracking (auto vs manual)
5. ✅ System status indicators show AI pipeline health and connection status
6. ✅ Mobile-responsive design preparing for future mobile app consistency

## Dev Notes

### Epic Context
This story creates the primary user interface where creators interact with VibeLayerAI. It brings together all the backend functionality (WebSocket, AI, effects) into a cohesive control experience. This is what creators see and use during their streams.

### Story Dependencies
- **Depends On:** Stories 1.1, 1.2, 1.5 (infrastructure, WebSocket, effects)
- **Enhanced By:** Stories 1.3, 1.4, 1.6 (audio, AI, safety)
- **Parallel Potential:** Can work alongside Story 1.8 (mobile validation)

### Technical Architecture

#### UI Stack (from docs/architecture/3-tech-stack.md)
- **Framework:** Next.js 15 with App Router
- **Components:** shadcn/ui for consistent design
- **State:** Zustand for real-time updates
- **Styling:** Tailwind CSS 4.x
- **Icons:** Lucide React

#### Component Architecture
```typescript
interface ControlPanelState {
  suggestions: AISuggestion[];
  activeEffects: ActiveEffect[];
  effectHistory: EffectActivation[];
  systemStatus: SystemStatus;
  settings: CreatorSettings;
}

interface AISuggestion {
  id: string;
  effect: Effect;
  confidence: number;
  intent: IntentType;
  timestamp: Date;
  status: 'pending' | 'accepted' | 'rejected';
}
```

### Implementation Tasks

#### Task 1: Create Dashboard Layout
- [ ] Build main dashboard structure with grid layout
- [ ] Create sidebar navigation component
- [ ] Implement header with status indicators
- [ ] Add responsive breakpoints for mobile
- [ ] Set up dark/light theme support

#### Task 2: Build Suggestion Queue
- [ ] Create suggestion card component
- [ ] Implement real-time WebSocket updates
- [ ] Add confidence meter visualization
- [ ] Create accept/reject actions
- [ ] Add auto-accept threshold setting

#### Task 3: Implement Effect Library
- [ ] Create effect grid/list view toggle
- [ ] Build effect card with preview
- [ ] Add instant search functionality
- [ ] Implement category filters
- [ ] Create manual trigger buttons

#### Task 4: Create Settings Panel
- [ ] Build settings form with tabs
- [ ] Add audio sensitivity controls
- [ ] Create auto-trigger toggles
- [ ] Implement threshold sliders
- [ ] Add save/reset functionality

#### Task 5: Build Activity History
- [ ] Create timeline component
- [ ] Display effect activations
- [ ] Show trigger source (AI/manual)
- [ ] Add time-based filtering
- [ ] Implement export functionality

#### Task 6: Add System Status
- [ ] Create status indicator components
- [ ] Show WebSocket connection state
- [ ] Display AI pipeline health
- [ ] Add latency metrics
- [ ] Create alert notifications

#### Task 7: Implement Real-Time Updates
- [ ] Set up Zustand store structure
- [ ] Connect WebSocket to store
- [ ] Implement optimistic updates
- [ ] Add connection retry logic
- [ ] Create offline mode handling

#### Task 8: Polish UI/UX
- [ ] Add loading states
- [ ] Create empty states
- [ ] Implement error boundaries
- [ ] Add keyboard shortcuts
- [ ] Create onboarding tour

### File Locations
- Dashboard: `/apps/control-panel/src/app/dashboard/`
- Components: `/apps/control-panel/src/components/dashboard/`
- Stores: `/apps/control-panel/src/stores/`
- Hooks: `/apps/control-panel/src/hooks/`
- Settings: `/apps/control-panel/src/app/settings/`

### Testing Requirements
- Unit tests for all components
- Integration tests for WebSocket updates
- E2E tests for critical workflows
- Accessibility tests (WCAG 2.1 AA)
- Performance tests for real-time updates
- Mobile responsiveness tests
- Browser compatibility tests

### Technical Constraints
- Must update within 50ms of WebSocket message
- Support 100+ suggestions in queue
- Instant search (<100ms response)
- Mobile breakpoint at 768px
- Maximum bundle size: 500KB
- Support last 2 versions of major browsers

## Definition of Done
- [ ] Dashboard layout complete and responsive
- [ ] Suggestion queue showing real-time updates
- [ ] Effect library with search and filters
- [ ] Settings panel functional
- [ ] Activity history tracking all events
- [ ] System status indicators accurate
- [ ] WebSocket integration working
- [ ] Mobile responsive design verified
- [ ] Accessibility standards met
- [ ] Documentation and help text added