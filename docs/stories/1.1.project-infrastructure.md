# Story 1.1: Project Infrastructure & Web Control Panel Foundation

## Status
Review

## Story
**As a** development team and creator,
**I want** comprehensive project setup with immediate creator interface,
**so that** creators can access the system while we maintain development efficiency.

## Acceptance Criteria
1. pnpm workspace monorepo configured with mobile architecture planning documentation
2. Next.js 15 control panel with basic creator signup, authentication, and microphone permissions
3. Shared packages with mobile compatibility: effects-engine, protocol, brand-kit, config
4. CI/CD pipeline with performance profiling infrastructure and mobile testing preparation
5. Security framework (Doppler, CSP, SRI) with mobile app security requirements documented
6. Basic creator dashboard with system status and connection indicators

## Tasks / Subtasks
- [ ] Configure pnpm workspace monorepo (AC: 1)
  - [ ] Configure pnpm-workspace.yaml with all required packages
  - [ ] Set up Turbo build orchestration with turbo.json configuration
  - [ ] Establish TypeScript configuration inheritance across workspace
  - [ ] Configure package interdependencies and build order
- [ ] Implement Next.js 15 control panel foundation (AC: 2)
  - [ ] Initialize Next.js 15 with App Router in apps/control-panel/
  - [ ] Set up shadcn/ui component library with Tailwind CSS
  - [ ] Implement BetterAuth authentication with JWT + EdDSA
  - [ ] Create basic creator signup/login forms with validation
  - [ ] Add microphone permission request handling
- [ ] Create shared packages structure (AC: 3)
  - [ ] Initialize packages/shared-types with TypeScript interfaces
  - [ ] Create packages/effects-engine with cross-platform abstraction
  - [ ] Set up packages/protocol with WebSocket message definitions
  - [ ] Initialize packages/brand-kit with scoring algorithms
  - [ ] Create packages/config with shared configuration
- [ ] Set up CI/CD pipeline (AC: 4)
  - [ ] Configure GitHub Actions workflows for testing and deployment
  - [ ] Set up Vitest for frontend and backend unit testing
  - [ ] Configure Playwright for E2E testing
  - [ ] Add performance profiling with Sentry integration
  - [ ] Set up mobile testing preparation infrastructure
- [ ] Implement security framework (AC: 5)
  - [ ] Configure Doppler for secret management
  - [ ] Set up CSP (Content Security Policy) headers
  - [ ] Implement SRI (Subresource Integrity) for assets
  - [ ] Document mobile app security requirements
  - [ ] Add rate limiting middleware (100 req/min per user)
- [ ] Create basic creator dashboard (AC: 6)
  - [ ] Build dashboard layout with responsive design
  - [ ] Add system status indicators for services
  - [ ] Implement WebSocket connection status display
  - [ ] Create navigation structure for future features
  - [ ] Add basic analytics placeholder components

## Dev Notes

### Previous Story Insights
This is the first story in Epic 1, no previous story context available.

### Data Models
**Creator Model** [Source: docs/architecture/4-data-models.md#Creator]:
```typescript
interface Creator {
  id: string;
  email: string;
  displayName: string;
  brandKit: BrandKit;
  subscriptionTier: 'free' | 'creator' | 'professional' | 'enterprise';
  platforms: PlatformConnection[];
  settings: CreatorSettings;
  createdAt: Date;
  updatedAt: Date;
}
```

**Creator Settings** [Source: docs/architecture/9-database-schema.md]:
```typescript
interface CreatorSettings {
  autoTriggerEnabled: boolean;
  suggestionThreshold: number;
  panicHotkeyEnabled: boolean;
}
```

### API Specifications
**Authentication Endpoints** [Source: docs/architecture/5-api-specification.md]:
- POST /api/auth/login - Creator authentication
- POST /api/auth/refresh - Token refresh
- POST /api/auth/logout - Session termination

**Creator Profile Endpoints** [Source: docs/architecture/5-api-specification.md]:
- GET /api/creators/profile - Get creator profile data

### Component Specifications
**Component Architecture** [Source: docs/architecture/10-frontend-architecture.md#Component Architecture]:
- Atomic Design pattern with domain-specific groupings
- Components organized in atoms/, molecules/, organisms/, templates/
- Standard component template with TypeScript interfaces
- Accessibility requirements with proper ARIA labels

**Authentication Components** [Source: docs/architecture/10-frontend-architecture.md]:
- withAuth HOC for route protection
- Automatic redirect to /auth/login for unauthenticated users
- Token management with secure storage

### File Locations
**Project Structure** [Source: docs/architecture/12-unified-project-structure.md]:
```
apps/control-panel/         # Next.js web app
├── src/
│   ├── components/         # React components (Atomic Design)
│   ├── app/               # Next.js 15 App Router
│   ├── hooks/             # Custom React hooks  
│   ├── services/          # API client services
│   ├── stores/            # Zustand state management
│   └── utils/             # Frontend utilities
├── public/                # Static assets
├── tests/                 # Frontend tests (Vitest + Playwright)
└── package.json

packages/shared-types/      # TypeScript interfaces
packages/effects-engine/    # Cross-platform effects
packages/protocol/          # WebSocket protocol
packages/brand-kit/         # Brand consistency
packages/config/           # Shared configurations
```

**API Services Structure** [Source: docs/architecture/11-backend-architecture.md]:
```
api/auth/
├── login.ts              # POST /api/auth/login
├── refresh.ts            # POST /api/auth/refresh  
└── logout.ts             # POST /api/auth/logout
```

### Testing Requirements
**Testing Strategy** [Source: docs/architecture/16-testing-strategy.md]:
- Vitest for frontend and backend unit testing
- Playwright for E2E testing
- Testing pyramid: 70% unit, 20% integration, 10% E2E
- Test files located in apps/control-panel/tests/
- Component testing with @testing-library/react
- API testing with Supertest

**Test Organization** [Source: docs/architecture/16-testing-strategy.md]:
```
apps/control-panel/tests/
├── unit/                 # Component and hook tests
├── integration/          # Feature integration tests
└── e2e/                  # End-to-end user journeys
```

### Technical Constraints
**Tech Stack Requirements** [Source: docs/architecture/3-tech-stack.md]:
- Next.js 15.x with App Router
- TypeScript 5.6.3 for type safety
- shadcn/ui component library
- Zustand 5.x for state management
- BetterAuth for authentication with JWT + EdDSA
- Tailwind CSS 4.x for styling
- Turbo 2.x for monorepo build orchestration
- pnpm for package management

**Coding Standards** [Source: docs/architecture/17-coding-standards.md]:
- Type sharing via @vibelayer/types alias from packages/shared-types
- API calls through service layer from @vibelayer/services
- Environment variables accessed through @vibelayer/config only
- PascalCase for components, camelCase for hooks
- Authentication middleware required for all protected routes

### Project Structure Notes
Current project structure aligns well with architecture specifications:
- ✅ pnpm workspace with pnpm-workspace.yaml exists
- ✅ apps/ directory structure matches architecture  
- ✅ packages/ directory present for shared packages
- ✅ Convex database configuration ready
- ⚠️ Need to create missing shared packages (effects-engine, protocol, brand-kit, config)

## Testing
**Testing Standards** [Source: docs/architecture/16-testing-strategy.md]:
- **Test file location**: apps/control-panel/tests/ with unit/, integration/, e2e/ subdirectories
- **Test frameworks**: Vitest for unit/integration, Playwright for E2E
- **Testing patterns**: Component testing with @testing-library/react, API testing with Supertest
- **Specific requirements**: All components must have unit tests, authentication flows must have integration tests, complete user signup/login workflow must have E2E test

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-09 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References  
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be populated here*